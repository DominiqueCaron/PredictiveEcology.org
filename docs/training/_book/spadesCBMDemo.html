<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="CÃ©line Boisvenue">
<meta name="author" content="Camille Giuliano">
<meta name="dcterms.date" content="2024-11-15">

<title>Robust and nimble scientific workflows, using SpaDES - 16&nbsp; Forest Carbon Modelling in SpaDES with setupProject</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bestPractices.html" rel="next">
<link href="./ForestsAndFire.html" rel="prev">
<link href="./assets/logo/favicon-16x16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/css/main.scss">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./assets/logo/favicon-196x196.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Robust and nimble scientific workflows, using SpaDES</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../../index.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../../Projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../../SpaDES.html"> 
<span class="menu-text">SpaDES</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-workshops" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Workshops</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-workshops">    
        <li>
    <a class="dropdown-item" href="./../../Workshops.html">
 <span class="dropdown-text">Workshops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../../workshops/June-2024-SpaDES-workshop.html">
 <span class="dropdown-text">June 2024 Workshop Agenda</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../../workshops/Nov-2024-SpaDES-workshop.html">
 <span class="dropdown-text">November 2024 Workshop Agenda</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-training" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Training</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-training">    
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">Training Book</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../otherTraining.html">
 <span class="dropdown-text">Other training resources</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./../../Manuals.html"> 
<span class="menu-text">Manuals</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/PredictiveEcology"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/PredictiveEcol"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./setupProject.html">SpaDES workflows and projects</a></li><li class="breadcrumb-item"><a href="./spadesCBMDemo.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Forest Carbon Modelling in SpaDES with <code>setupProject</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./settingUp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setting up your computer and system</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installRandSpatialPkgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installing R and Spatial Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PackagesForBook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Pre-installing R packages for book</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TroubleshootingPackageInstallation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Troubleshooting R package installation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./SpaDESbasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SpaDES 101</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NewModuleIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to SpaDES Modules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MetaDataAndModuleFiles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Module Files and Metadata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModuleInputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Providing Module Inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simList.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The <code>simList</code> - What is it?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModulesAndEvents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modules, Events and Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Scheduling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Scheduling Events</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ContinuousWorkflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Continuous Workflows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Caching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Cache</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prepInputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><code>reproducible::prepInputs</code> for Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Debugging SpaDES Modules</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./setupProject.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SpaDES workflows and projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflowSimple2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Workflows with <code>setupProject</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LandRDemo_coreVeg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forest Landscape Modelling with LandR and <code>setupProject</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForestsAndFire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Forest Succession and Wildfire using <code>setupProject</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spadesCBMDemo.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Forest Carbon Modelling in SpaDES with <code>setupProject</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bestPractices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best practices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#spadescbm-modules" id="toc-spadescbm-modules" class="nav-link active" data-scroll-target="#spadescbm-modules"><span class="header-section-number">16.1</span> spadesCBM Modules</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">16.2</span> Setup</a></li>
  <li><a href="#run-simulation" id="toc-run-simulation" class="nav-link" data-scroll-target="#run-simulation"><span class="header-section-number">16.3</span> Run Simulation</a></li>
  <li><a href="#looking-at-results" id="toc-looking-at-results" class="nav-link" data-scroll-target="#looking-at-results"><span class="header-section-number">16.4</span> Looking at results</a>
  <ul class="collapse">
  <li><a href="#outputs" id="toc-outputs" class="nav-link" data-scroll-target="#outputs"><span class="header-section-number">16.4.1</span> Outputs</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting"><span class="header-section-number">16.4.2</span> Plotting</a></li>
  </ul></li>
  <li><a href="#changing-the-length-of-the-simulation" id="toc-changing-the-length-of-the-simulation" class="nav-link" data-scroll-target="#changing-the-length-of-the-simulation"><span class="header-section-number">16.5</span> Changing the length of the simulation</a></li>
  <li><a href="#barebones-script" id="toc-barebones-script" class="nav-link" data-scroll-target="#barebones-script"><span class="header-section-number">16.6</span> Barebones script</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./setupProject.html">SpaDES workflows and projects</a></li><li class="breadcrumb-item"><a href="./spadesCBMDemo.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Forest Carbon Modelling in SpaDES with <code>setupProject</code></span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Forest Carbon Modelling in SpaDES with <code>setupProject</code></span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>CÃ©line Boisvenue </p>
             <p>Camille Giuliano </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 15, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>See [Barebones R script] for the code shown in this chapter</p>
</div>
</div>
</div>
<p>spadesCBM is a modular, transparent, and spatially explicit implementation of the logic, pools structure, equations, and default assumptions of the Carbon Budget Model of the Canadian Forest Sector <a href="https://natural-resources.canada.ca/climate-change/climate-change-impacts-forests/carbon-accounting/carbon-budget-model/13107">CBM</a>. It applies the science presented in <span class="citation" data-cites="kurz2009">Kurz et al. (<a href="references.html#ref-kurz2009" role="doc-biblioref">2009</a>)</span> in a similar way to the simulations in <span class="citation" data-cites="boisvenue2016">Boisvenue et al. (<a href="references.html#ref-boisvenue2016" role="doc-biblioref">2016</a>)</span> and <span class="citation" data-cites="boisvenue2022">Boisvenue et al. (<a href="references.html#ref-boisvenue2022" role="doc-biblioref">2022</a>)</span> but calls Python functions for annual processes. These functions are, like much of modelling-based science, continuously under development.</p>
<section id="spadescbm-modules" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="spadescbm-modules"><span class="header-section-number">16.1</span> spadesCBM Modules</h2>
<p>Four modules need to be run in tandem for a spadesCBM simulation (see <a href="#setup">Setup</a><br>
for how these relate in SpaDES). The first module <em>CBM_defaults</em> reads in defaults CBM parameters for Canada. The second module <em>CBM_dataPrep_SK</em> is a data preparation SpaDES module, where input data and spatial layers are assembled and prepared for a specific study area (the <em>SK</em> indicates the specific study area or scenario, in this example it is a small raster in Saskatchewan). In spadesCBM, as in CBM, growth curves are the main change-agent. The third module <em>CBM_vol2biomass</em> translates user-provided growth curves (<span class="math inline">\(m^3/ha\)</span>) into increments for specific above ground carbon pools (metric tonnes of carbon/ha) using <span class="citation" data-cites="boudewyn2007">Boudewyn et al. (<a href="references.html#ref-boudewyn2007" role="doc-biblioref">2007</a>)</span> models to which we added a smoothing algorithm. These three modules provide the inputs to the <em>CBM_core</em> module where processes are applied on a yearly time step. This modularity enables users to access and change default parameters, change inputs, and assess the impact of these changes. We are working on some implementations of this modularity and making these available to the community. We hope others will do the same. A manual describing spadesCBM in detail is forthcoming. The link to the manual will be posted here.</p>
<p>Several core utilities to <code>spadesCBM</code> are provided by the <a href="https://github.com/PredictiveEcology/CBMutils@development"><code>CBMutils</code></a> package, available on GitHub. Active development in <code>CBMutils</code> and all <code>spadesCBM</code> modules is underway.</p>
</section>
<section id="setup" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="setup"><span class="header-section-number">16.2</span> Setup</h2>
<p>In this example, we will setup the workflow using <code>setupProject</code> from the <a href="https://spades-project.predictiveecology.org/"><code>SpaDES.project</code></a> package and current versions of the spadesCBM modules.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Google account needed for this example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Like the LandR example, you will need to access some of the data using the <code>googledrive</code> R package (part of the <code>tidyverse</code> family). During the <code>simInit()</code> (or <code>simInitAndSpades()</code>) call R will prompt you to either choose a previously authenticated account (if you have previously used <code>googledrive</code>) or to open a browser window and authenticate. If this doesnât work, try this workaround:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"googledrive"</span>, <span class="st">"httpuv"</span>), <span class="at">repos =</span> repos)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>googledriveAuthPath <span class="ot">&lt;-</span> <span class="st">"~/SpaDES_book/googledrive_auth_cache"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(googledriveAuthPath, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>googledrive<span class="sc">::</span><span class="fu">drive_auth</span>(<span class="at">cache =</span> <span class="st">"~/SpaDES_book/googledrive_auth_cache"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Make sure you give <code>tidyverse</code> read/write access to your files:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/img/gdriveauth.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="467"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python is required for this example
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>CBM_core</em> module requires Python &gt;=3.9 and &lt;=3.12.7.</p>
<p>If a suitable version of Python does not already exist on your computer, <code>setupProject</code> will use the <a href="https://rstudio.github.io/reticulate/"><code>reticulate</code></a> package to install it using the <a href="https://github.com/pyenv/pyenv">pyenv</a> or <a href="https://github.com/pyenv-win/pyenv-win">pyenv-win</a> project.</p>
<p>If you are using a Windows computer with Git installed, the <code>pyenv-win</code> tool will be acquired and managed directly by <code>reticulate</code>. If you are using a Windows computer without Git installed, you will be prompted to allow the <code>pyenv-win</code> tool to be downloaded directly from Github to your local user application data directory (<code>tools::R_user_dir("r-spadesCBM")</code>).</p>
<p>If the Python installation process fails or you would prefer to manually install Python, it can be downloaded directly from <a href="https://python.org/downloads">python.org/downloads</a>.</p>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>projectPath <span class="ot">&lt;-</span> <span class="st">"~/spadesCBMpython"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(projectPath, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(projectPath)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>repos <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="st">"predictiveecology.r-universe.dev"</span>, <span class="fu">getOption</span>(<span class="st">"repos"</span>)))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"SpaDES.project"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> repos)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># start in 1998, and end in 2000</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">start =</span> <span class="dv">1998</span>, <span class="at">end =</span> <span class="dv">2000</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> SpaDES.project<span class="sc">::</span><span class="fu">setupProject</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Restart =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">useGit =</span> <span class="st">"PredictiveEcology"</span>, <span class="co"># a developer sets and keeps this = TRUE</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="co"># a user who wants to get latest modules sets this to TRUE</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">paths =</span> <span class="fu">list</span>(<span class="at">projectPath =</span> projectPath),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">options</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">repos =</span> <span class="fu">c</span>(<span class="at">repos =</span> repos),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Require.cloneFrom =</span> <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">reproducible.destinationPath =</span> <span class="st">"inputs"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="do">## These are for speed</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">reproducible.useMemoise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Require.offlineMode = TRUE,</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">spades.moduleCodeChecks =</span> <span class="cn">FALSE</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">modules =</span>  <span class="fu">c</span>(<span class="st">"PredictiveEcology/CBM_defaults@training"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_dataPrep_SK@training"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_vol2biomass@training"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_core@training"</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">times =</span> times,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">require =</span> <span class="fu">c</span>(<span class="st">"SpaDES.core"</span>, <span class="st">"reticulate"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>              <span class="st">"PredictiveEcology/libcbmr"</span>, <span class="st">"data.table"</span>),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_defaults =</span> <span class="fu">list</span>(</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_dataPrep_SK =</span> <span class="fu">list</span>(</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_vol2biomass =</span> <span class="fu">list</span>(</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> <span class="st">"PredictiveEcology/CBM_core@training/R/ReticulateFindPython.R"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret =</span> {</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    reticulate<span class="sc">::</span><span class="fu">virtualenv_create</span>(</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"r-spadesCBM"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">python =</span> <span class="cf">if</span> (<span class="sc">!</span>reticulate<span class="sc">::</span><span class="fu">virtualenv_exists</span>(<span class="st">"r-spadesCBM"</span>)){</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ReticulateFindPython</span>(</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">version        =</span> <span class="st">"&gt;=3.9,&lt;=3.12.7"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">versionInstall =</span> <span class="st">"3.10:latest"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">pyenvRoot      =</span> tools<span class="sc">::</span><span class="fu">R_user_dir</span>(<span class="st">"r-spadesCBM"</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">packages =</span> <span class="fu">c</span>(</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numpy&lt;2"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pandas&gt;=1.1.5"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"scipy"</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numexpr&gt;=2.8.7"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numba"</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pyyaml"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mock"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"openpyxl"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"libcbm"</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    reticulate<span class="sc">::</span><span class="fu">use_virtualenv</span>(<span class="st">"r-spadesCBM"</span>)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### begin manually passed inputs #########################################</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## define the  study area.</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> {</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    extent <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">ext</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">687696</span>, <span class="at">xmax =</span> <span class="sc">-</span><span class="dv">681036</span>, <span class="at">ymin =</span> <span class="dv">711955</span>, <span class="at">ymax =</span> <span class="dv">716183</span>))</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    masterRaster <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(extent, <span class="at">res =</span> <span class="dv">30</span>)</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">crs</span>(masterRaster) <span class="ot">&lt;-</span> <span class="st">"PROJCRS[</span><span class="sc">\"</span><span class="st">Lambert_Conformal_Conic_2SP</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">    BASEGEOGCRS[</span><span class="sc">\"</span><span class="st">GCS_GRS_1980_IUGG_1980</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">        DATUM[</span><span class="sc">\"</span><span class="st">D_unknown</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">            ELLIPSOID[</span><span class="sc">\"</span><span class="st">GRS80</span><span class="sc">\"</span><span class="st">,6378137,298.257222101,</span><span class="sc">\n</span><span class="st">                LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                    ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]]],</span><span class="sc">\n</span><span class="st">        PRIMEM[</span><span class="sc">\"</span><span class="st">Greenwich</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9122]]]],</span><span class="sc">\n</span><span class="st">    CONVERSION[</span><span class="sc">\"</span><span class="st">Lambert Conic Conformal (2SP)</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">        METHOD[</span><span class="sc">\"</span><span class="st">Lambert Conic Conformal (2SP)</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9802]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of false origin</span><span class="sc">\"</span><span class="st">,49,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8821]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Longitude of false origin</span><span class="sc">\"</span><span class="st">,-95,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8822]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of 1st standard parallel</span><span class="sc">\"</span><span class="st">,49,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8823]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of 2nd standard parallel</span><span class="sc">\"</span><span class="st">,77,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8824]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Easting at false origin</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8826]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Northing at false origin</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8827]]],</span><span class="sc">\n</span><span class="st">    CS[Cartesian,2],</span><span class="sc">\n</span><span class="st">        AXIS[</span><span class="sc">\"</span><span class="st">easting</span><span class="sc">\"</span><span class="st">,east,</span><span class="sc">\n</span><span class="st">            ORDER[1],</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]],</span><span class="sc">\n</span><span class="st">        AXIS[</span><span class="sc">\"</span><span class="st">northing</span><span class="sc">\"</span><span class="st">,north,</span><span class="sc">\n</span><span class="st">            ORDER[2],</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]]]"</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    masterRaster[] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, terra<span class="sc">::</span><span class="fu">ncell</span>(masterRaster))</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    mr <span class="ot">&lt;-</span> reproducible<span class="sc">::</span><span class="fu">prepInputs</span>(<span class="at">url =</span> <span class="st">"https://drive.google.com/file/d/1zUyFH8k6Ef4c_GiWMInKbwAl6m6gvLJW/view?usp=drive_link"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">destinationPath =</span> <span class="st">"inputs"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">to =</span> masterRaster,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">"near"</span>)</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    mr[mr[] <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    mr</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Give the location of the disturbance rasters.</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">disturbanceRasters =</span> <span class="st">"https://drive.google.com/file/d/12YnuQYytjcBej0_kdodLchPg7z9LygCt/view?usp=drive_link"</span>,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restart = getOption("SpaDES.project.Restart", FALSE),</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">outputs =</span> <span class="fu">as.data.frame</span>(<span class="fu">expand.grid</span>(<span class="at">objectName =</span> <span class="fu">c</span>(<span class="st">"cbmPools"</span>, <span class="st">"NPP"</span>),</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">saveTime =</span> <span class="fu">sort</span>(<span class="fu">c</span>(times<span class="sc">$</span>start,</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>                                                        times<span class="sc">$</span>start <span class="sc">+</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(times<span class="sc">$</span>end <span class="sc">-</span> times<span class="sc">$</span>start))</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>                                      )))),</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>loadOrder <span class="ot">&lt;-</span> <span class="fu">unlist</span>(out<span class="sc">$</span>modules)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="run-simulation" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="run-simulation"><span class="header-section-number">16.3</span> Run Simulation</h2>
<p>Now that our project is set up, we can run our simulation.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>simPython <span class="ot">&lt;-</span> <span class="fu">do.call</span>(SpaDES.core<span class="sc">::</span>simInitAndSpades, out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="looking-at-results" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="looking-at-results"><span class="header-section-number">16.4</span> Looking at results</h2>
<section id="outputs" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="outputs"><span class="header-section-number">16.4.1</span> Outputs</h3>
<p>In our <code>setupProject()</code> call, we defined certain outputs to be saved by specifying <code>out$outputs</code>. Look at that table. It defines what is saved in the <em>output</em> folder. You can also see a list of these outputs your simulation has created, their name, and where they were saved by using the <code>outputs()</code> function like so:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">outputs</span>(simPython)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  objectName saveTime                                                                      file     </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   cbmPools     <span class="dv">1998</span> <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>cbmPools_year1998.rds saveRDS    base  <span class="cn">TRUE</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        NPP     <span class="dv">1998</span>      <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>NPP_year1998.rds saveRDS    base  <span class="cn">TRUE</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   cbmPools     <span class="dv">1999</span> <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>cbmPools_year1999.rds saveRDS    base  <span class="cn">TRUE</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        NPP     <span class="dv">1999</span>      <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>NPP_year1999.rds saveRDS    base  <span class="cn">TRUE</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   cbmPools     <span class="dv">2000</span> <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>cbmPools_year2000.rds saveRDS    base  <span class="cn">TRUE</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>        NPP     <span class="dv">2000</span>      <span class="sc">~</span><span class="er">/</span>spadesCBMpython<span class="sc">/</span>outputs<span class="sc">/</span>NPP_year2000.rds saveRDS    base  <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In our simulation, as defined in <code>setupProject()</code> with <code>out$outputs</code>, we have <code>cbmPools.rds</code> and <code>NPP.rds</code> files for each simulation year. These files are in the <code>outputs</code> folder created in the project directory defined in our <a href="#setup">Setup</a>. You can look at the these if you would like to explore results.</p>
</section>
<section id="plotting" class="level3" data-number="16.4.2">
<h3 data-number="16.4.2" class="anchored" data-anchor-id="plotting"><span class="header-section-number">16.4.2</span> Plotting</h3>
<p>We can also visualize some results using some plotting functions sourced from our modules.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">carbonOutPlot</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">emissionsProducts =</span> simPython<span class="sc">$</span>emissionsProducts</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># This plots yearly forest products and yearly emissions for the length of the simulation</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">barPlot</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">cbmPools =</span> simPython<span class="sc">$</span>cbmPools</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>   ) <span class="co"># This plots the carbon proportions above and below ground each simulation year</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">NPPplot</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatialDT =</span> simPython<span class="sc">$</span>spatialDT,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">NPP =</span> simPython<span class="sc">$</span>NPP,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> simPython<span class="sc">$</span>masterRaster</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># This plots the per-pixel average net primary production </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">spatialPlot</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cbmPools =</span> simPython<span class="sc">$</span>cbmPools,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">years =</span> <span class="dv">2000</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> simPython<span class="sc">$</span>masterRaster,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatialDT =</span> simPython<span class="sc">$</span>spatialDT</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># this plots the Total Carbon per pixel for the final simulation year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>You can also schedule these plots in your simulation. To do that a <code>plot</code> event has to be scheduled within a module. We want the plots to be automatically generated at the end of the simulation. In the <code>CBM_core.R</code> module, we already have a <code>plot</code> event defined in the <code>doEvent.CBM_core()</code> function.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">=</span> {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">time</span>(sim) <span class="sc">!=</span> <span class="fu">start</span>(sim)) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">retry</span>(<span class="fu">quote</span>({</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">carbonOutPlot</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">emissionsProducts =</span> sim<span class="sc">$</span>emissionsProducts</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        }), <span class="at">retries =</span> <span class="dv">2</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">barPlot</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">cbmPools =</span> sim<span class="sc">$</span>cbmPools</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">NPPplot</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">spatialDT =</span> sim<span class="sc">$</span>spatialDT,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">NPP =</span> sim<span class="sc">$</span>NPP,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">masterRaster =</span> sim<span class="sc">$</span>masterRaster</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">spatialPlot</span>(</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">cbmPools =</span> sim<span class="sc">$</span>cbmPools,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">years =</span> <span class="fu">time</span>(sim),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">masterRaster =</span> sim<span class="sc">$</span>masterRaster,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">spatialDT =</span> sim<span class="sc">$</span>spatialDT</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Even though the <code>event</code> (plot) exists, we had not scheduled this event in the simulation you just ran. If you look a few lines above where the plots are defined in the module (on line 186 in the <code>CBM_core.R</code> module), you will find a line of code currently commented out. If this line was being read, this would schedule the plotting event at the very end of the simulation (i.e., <code>eventPriority = 12</code>).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sim &lt;- scheduleEvent(sim, end(sim), "CBM_core", "plot",  eventPriority = 12)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>You can remove the comment # to add this line of code back in, save <code>CBM_core.R</code>, and rerun your simulation. The plotting is now a scheduled event in this module. The model will now automatically run the plotting functions above.</p>
</section>
</section>
<section id="changing-the-length-of-the-simulation" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="changing-the-length-of-the-simulation"><span class="header-section-number">16.5</span> Changing the length of the simulation</h2>
<p>We currently are running our simulation for three years, from 1998 to 2000. This is defined in the script provided in the <a href="#setup">Setup</a> section above by <code>times &lt;- list(start = 1998, end = 2000)</code>. You can explore the time steps, start and end times, and units in this simulation like so:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">times</span>(simPython)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To change the length of the simulation, we have to make sure we have the required inputs. If we keep the same study area, with the same growth information, and inventory information, we only need disturbance information for each year to extend the simulations. We have access to disturbance rasters from 1985 to 2011 via the <code>out$disturbanceRasters</code> in our <a href="#setup">Setup</a> section above. We can change the length of our simulation to a later year, and even resume our simulations where we left off. Here, we set the last year of the simulation to 2002:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">end</span>(simPython) <span class="ot">&lt;-</span> <span class="dv">2002</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And now we resume the simulation using <code>simPython</code> to 2002, and create a new <code>simList</code>, <code>simPython2</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>simPython2 <span class="ot">&lt;-</span> <span class="fu">spades</span>(simPython)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With <code>simPython2</code>, you can look at your results and generate plots in the same way as we did with the three year simulation <code>simPython</code> earlier.</p>
</section>
<section id="barebones-script" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="barebones-script"><span class="header-section-number">16.6</span> Barebones script</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>projectPath <span class="ot">&lt;-</span> <span class="st">"~/spadesCBMpython"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(projectPath, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(projectPath)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>repos <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="st">"predictiveecology.r-universe.dev"</span>, <span class="fu">getOption</span>(<span class="st">"repos"</span>)))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"SpaDES.project"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> repos)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># start in 1998, and end in 2000</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">start =</span> <span class="dv">1998</span>, <span class="at">end =</span> <span class="dv">2000</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> SpaDES.project<span class="sc">::</span><span class="fu">setupProject</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Restart =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">useGit =</span> <span class="st">"PredictiveEcology"</span>, <span class="co"># a developer sets and keeps this = TRUE</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="co"># a user who wants to get latest modules sets this to TRUE</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">paths =</span> <span class="fu">list</span>(<span class="at">projectPath =</span> projectPath),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">options</span>(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">repos =</span> <span class="fu">c</span>(<span class="at">repos =</span> repos),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Require.cloneFrom =</span> <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">reproducible.destinationPath =</span> <span class="st">"inputs"</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="do">## These are for speed</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">reproducible.useMemoise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Require.offlineMode = TRUE,</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">spades.moduleCodeChecks =</span> <span class="cn">FALSE</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">modules =</span>  <span class="fu">c</span>(<span class="st">"PredictiveEcology/CBM_defaults@training"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_dataPrep_SK@training"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_vol2biomass@training"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PredictiveEcology/CBM_core@training"</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">times =</span> times,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">require =</span> <span class="fu">c</span>(<span class="st">"SpaDES.core"</span>, <span class="st">"reticulate"</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>              <span class="st">"PredictiveEcology/libcbmr"</span>, <span class="st">"data.table"</span>),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_defaults =</span> <span class="fu">list</span>(</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_dataPrep_SK =</span> <span class="fu">list</span>(</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">CBM_vol2biomass =</span> <span class="fu">list</span>(</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">.useCache =</span> <span class="cn">TRUE</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> <span class="st">"PredictiveEcology/CBM_core@training/R/ReticulateFindPython.R"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret =</span> {</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    reticulate<span class="sc">::</span><span class="fu">virtualenv_create</span>(</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"r-spadesCBM"</span>,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">python =</span> <span class="cf">if</span> (<span class="sc">!</span>reticulate<span class="sc">::</span><span class="fu">virtualenv_exists</span>(<span class="st">"r-spadesCBM"</span>)){</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ReticulateFindPython</span>(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">version        =</span> <span class="st">"&gt;=3.9,&lt;=3.12.7"</span>,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">versionInstall =</span> <span class="st">"3.10:latest"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">pyenvRoot      =</span> tools<span class="sc">::</span><span class="fu">R_user_dir</span>(<span class="st">"r-spadesCBM"</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">packages =</span> <span class="fu">c</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numpy&lt;2"</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pandas&gt;=1.1.5"</span>,</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"scipy"</span>,</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numexpr&gt;=2.8.7"</span>,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numba"</span>,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pyyaml"</span>,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mock"</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"openpyxl"</span>,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"libcbm"</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    reticulate<span class="sc">::</span><span class="fu">use_virtualenv</span>(<span class="st">"r-spadesCBM"</span>)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### begin manually passed inputs #########################################</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## define the  study area.</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> {</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    extent <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">ext</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">687696</span>, <span class="at">xmax =</span> <span class="sc">-</span><span class="dv">681036</span>, <span class="at">ymin =</span> <span class="dv">711955</span>, <span class="at">ymax =</span> <span class="dv">716183</span>))</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    masterRaster <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(extent, <span class="at">res =</span> <span class="dv">30</span>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">crs</span>(masterRaster) <span class="ot">&lt;-</span> <span class="st">"PROJCRS[</span><span class="sc">\"</span><span class="st">Lambert_Conformal_Conic_2SP</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">    BASEGEOGCRS[</span><span class="sc">\"</span><span class="st">GCS_GRS_1980_IUGG_1980</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">        DATUM[</span><span class="sc">\"</span><span class="st">D_unknown</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">            ELLIPSOID[</span><span class="sc">\"</span><span class="st">GRS80</span><span class="sc">\"</span><span class="st">,6378137,298.257222101,</span><span class="sc">\n</span><span class="st">                LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                    ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]]],</span><span class="sc">\n</span><span class="st">        PRIMEM[</span><span class="sc">\"</span><span class="st">Greenwich</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9122]]]],</span><span class="sc">\n</span><span class="st">    CONVERSION[</span><span class="sc">\"</span><span class="st">Lambert Conic Conformal (2SP)</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">        METHOD[</span><span class="sc">\"</span><span class="st">Lambert Conic Conformal (2SP)</span><span class="sc">\"</span><span class="st">,</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9802]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of false origin</span><span class="sc">\"</span><span class="st">,49,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8821]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Longitude of false origin</span><span class="sc">\"</span><span class="st">,-95,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8822]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of 1st standard parallel</span><span class="sc">\"</span><span class="st">,49,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8823]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Latitude of 2nd standard parallel</span><span class="sc">\"</span><span class="st">,77,</span><span class="sc">\n</span><span class="st">            ANGLEUNIT[</span><span class="sc">\"</span><span class="st">degree</span><span class="sc">\"</span><span class="st">,0.0174532925199433],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8824]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Easting at false origin</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8826]],</span><span class="sc">\n</span><span class="st">        PARAMETER[</span><span class="sc">\"</span><span class="st">Northing at false origin</span><span class="sc">\"</span><span class="st">,0,</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1],</span><span class="sc">\n</span><span class="st">            ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,8827]]],</span><span class="sc">\n</span><span class="st">    CS[Cartesian,2],</span><span class="sc">\n</span><span class="st">        AXIS[</span><span class="sc">\"</span><span class="st">easting</span><span class="sc">\"</span><span class="st">,east,</span><span class="sc">\n</span><span class="st">            ORDER[1],</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]],</span><span class="sc">\n</span><span class="st">        AXIS[</span><span class="sc">\"</span><span class="st">northing</span><span class="sc">\"</span><span class="st">,north,</span><span class="sc">\n</span><span class="st">            ORDER[2],</span><span class="sc">\n</span><span class="st">            LENGTHUNIT[</span><span class="sc">\"</span><span class="st">metre</span><span class="sc">\"</span><span class="st">,1,</span><span class="sc">\n</span><span class="st">                ID[</span><span class="sc">\"</span><span class="st">EPSG</span><span class="sc">\"</span><span class="st">,9001]]]]"</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    masterRaster[] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, terra<span class="sc">::</span><span class="fu">ncell</span>(masterRaster))</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    mr <span class="ot">&lt;-</span> reproducible<span class="sc">::</span><span class="fu">prepInputs</span>(<span class="at">url =</span> <span class="st">"https://drive.google.com/file/d/1zUyFH8k6Ef4c_GiWMInKbwAl6m6gvLJW/view?usp=drive_link"</span>,</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">destinationPath =</span> <span class="st">"inputs"</span>,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">to =</span> masterRaster,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">"near"</span>)</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    mr[mr[] <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    mr</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Give the location of the disturbance rasters.</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">disturbanceRasters =</span> <span class="st">"https://drive.google.com/file/d/12YnuQYytjcBej0_kdodLchPg7z9LygCt/view?usp=drive_link"</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restart = getOption("SpaDES.project.Restart", FALSE),</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">outputs =</span> <span class="fu">as.data.frame</span>(<span class="fu">expand.grid</span>(<span class="at">objectName =</span> <span class="fu">c</span>(<span class="st">"cbmPools"</span>, <span class="st">"NPP"</span>),</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">saveTime =</span> <span class="fu">sort</span>(<span class="fu">c</span>(times<span class="sc">$</span>start,</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>                                                        times<span class="sc">$</span>start <span class="sc">+</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(times<span class="sc">$</span>end <span class="sc">-</span> times<span class="sc">$</span>start))</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                                      )))),</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>loadOrder <span class="ot">&lt;-</span> <span class="fu">unlist</span>(out<span class="sc">$</span>modules)</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Run</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>simPython <span class="ot">&lt;-</span> <span class="fu">do.call</span>(SpaDES.core<span class="sc">::</span>simInitAndSpades, out)</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at figures</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="fu">carbonOutPlot</span>(</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">emissionsProducts =</span> simPython<span class="sc">$</span>emissionsProducts</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># This plots yearly forest products and yearly emissions for the length of the simulation</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a> <span class="fu">barPlot</span>(</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>   <span class="at">cbmPools =</span> simPython<span class="sc">$</span>cbmPools</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>   ) <span class="co"># This plots the carbon proportions above and below ground each simulation year</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="fu">NPPplot</span>(</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatialDT =</span> simPython<span class="sc">$</span>spatialDT,</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">NPP =</span> simPython<span class="sc">$</span>NPP,</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> simPython<span class="sc">$</span>masterRaster</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># This plots the per-pixel average net primary production </span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a><span class="fu">spatialPlot</span>(</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">cbmPools =</span> simPython<span class="sc">$</span>cbmPools,</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">years =</span> <span class="dv">2000</span>,</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">masterRaster =</span> simPython<span class="sc">$</span>masterRaster,</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">spatialDT =</span> simPython<span class="sc">$</span>spatialDT</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># this plots the Total Carbon per pixel for the final simulation year</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at outputs</span></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a><span class="fu">outputs</span>(simPython)</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the length of your simulation</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a><span class="fu">times</span>(simPython)</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Extend your simulation by changing the end time</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="fu">end</span>(simPython) <span class="ot">&lt;-</span> <span class="dv">2002</span></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Resume the simulation</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>simPython2 <span class="ot">&lt;-</span> <span class="fu">spades</span>(simPython)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-boisvenue2022" class="csl-entry" role="listitem">
Boisvenue, C., G. Paradis, I. M. S. Eddy, E. J. B. McIntire, and A. M. Chubaty. 2022. <span>âManaging Forest Carbon and Landscape Capacities.â</span> <em>Environmental Research Letters</em>. <a href="https://doi.org/10.1088/1748-9326/ac9919">https://doi.org/10.1088/1748-9326/ac9919</a>.
</div>
<div id="ref-boisvenue2016" class="csl-entry" role="listitem">
Boisvenue, C., B. P. Smiley, J. C. White, W. A. Kurz, and M. A. Wulder. 2016. <span>âImproving Carbon Monitoring and Reporting in Forests Using Spatially-Explicit Information.â</span> <em>Carbon Balance and Management</em>. <a href="https://doi.org/10.1186/s13021-016-0065-6">https://doi.org/10.1186/s13021-016-0065-6</a>.
</div>
<div id="ref-boudewyn2007" class="csl-entry" role="listitem">
Boudewyn, P., X. Song, S. Magnussen, and M. D. Gillis. 2007. <span>âModel-Based, Volume-to-Biomass Conversion for Forested and Vegetated Land in Canada.â</span> Natural Resources Canada. <a href="https://cfs.nrcan.gc.ca/pubwarehouse/pdfs/27434.pdf">https://cfs.nrcan.gc.ca/pubwarehouse/pdfs/27434.pdf</a>.
</div>
<div id="ref-kurz2009" class="csl-entry" role="listitem">
Kurz, W. A., C. C. Dymond, T. M. White, G. Stinson, C. H. Shaw, G. J. Rampley, and C. et al. Smyth. 2009. <span>âCBM-CFS3: A Model of Carbon-Dynamics in Forestry and Land-Use Change Implementing IPCC Standards.â</span> <em>Ecological Modelling</em>. <a href="https://doi.org/10.1016/j.ecolmodel.2008.10.018">https://doi.org/10.1016/j.ecolmodel.2008.10.018</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/predictiveecology\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ForestsAndFire.html" class="pagination-link" aria-label="Forest Succession and Wildfire using `setupProject`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Forest Succession and Wildfire using <code>setupProject</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bestPractices.html" class="pagination-link" aria-label="Best practices">
        <span class="nav-page-text">Best practices</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>